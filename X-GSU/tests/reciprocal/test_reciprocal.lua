--emu.log(string.format("%x", emu.readWord(0x59b,emu.memType.gsuWorkRam,false)))
--emu.log("input")
--emu.log(emu.getLabelAddress("input"))
input = {0x8000,0x8004,0x8008,0x800c,0x8010,0x8014,0x8018,0x801c,0x8020,0x8024,0x8028,0x802c,0x8030,0x8034,0x8038,0x803c,0x8040,0x8044,0x8048,0x804c,0x8050,0x8054,0x8058,0x805c,0x8060,0x8064,0x8068,0x806c,0x8070,0x8074,0x8078,0x807c,0x8080,0x8084,0x8088,0x808c,0x8090,0x8094,0x8098,0x809c,0x80a0,0x80a4,0x80a8,0x80ac,0x80b0,0x80b4,0x80b8,0x80bc,0x80c0,0x80c4,0x80c8,0x80cc,0x80d0,0x80d4,0x80d8,0x80dc,0x80e0,0x80e4,0x80e8,0x80ec,0x80f0,0x80f4,0x80f8,0x80fc,0x9000,0x9004,0x9008,0x900c,0x9010,0x9014,0x9018,0x901c,0x9020,0x9024,0x9028,0x902c,0x9030,0x9034,0x9038,0x903c,0x9040,0x9044,0x9048,0x904c,0x9050,0x9054,0x9058,0x905c,0x9060,0x9064,0x9068,0x906c,0x9070,0x9074,0x9078,0x907c,0x9080,0x9084,0x9088,0x908c,0x9090,0x9094,0x9098,0x909c,0x90a0,0x90a4,0x90a8,0x90ac,0x90b0,0x90b4,0x90b8,0x90bc,0x90c0,0x90c4,0x90c8,0x90cc,0x90d0,0x90d4,0x90d8,0x90dc,0x90e0,0x90e4,0x90e8,0x90ec,0x90f0,0x90f4,0x90f8,0x90fc,0xa000,0xa004,0xa008,0xa00c,0xa010,0xa014,0xa018,0xa01c,0xa020,0xa024,0xa028,0xa02c,0xa030,0xa034,0xa038,0xa03c,0xa040,0xa044,0xa048,0xa04c,0xa050,0xa054,0xa058,0xa05c,0xa060,0xa064,0xa068,0xa06c,0xa070,0xa074,0xa078,0xa07c,0xa080,0xa084,0xa088,0xa08c,0xa090,0xa094,0xa098,0xa09c,0xa0a0,0xa0a4,0xa0a8,0xa0ac,0xa0b0,0xa0b4,0xa0b8,0xa0bc,0xa0c0,0xa0c4,0xa0c8,0xa0cc,0xa0d0,0xa0d4,0xa0d8,0xa0dc,0xa0e0,0xa0e4,0xa0e8,0xa0ec,0xa0f0,0xa0f4,0xa0f8,0xa0fc,0xb000,0xb004,0xb008,0xb00c,0xb010,0xb014,0xb018,0xb01c,0xb020,0xb024,0xb028,0xb02c,0xb030,0xb034,0xb038,0xb03c,0xb040,0xb044,0xb048,0xb04c,0xb050,0xb054,0xb058,0xb05c,0xb060,0xb064,0xb068,0xb06c,0xb070,0xb074,0xb078,0xb07c,0xb080,0xb084,0xb088,0xb08c,0xb090,0xb094,0xb098,0xb09c,0xb0a0,0xb0a4,0xb0a8,0xb0ac,0xb0b0,0xb0b4,0xb0b8,0xb0bc,0xb0c0,0xb0c4,0xb0c8,0xb0cc,0xb0d0,0xb0d4,0xb0d8,0xb0dc,0xb0e0,0xb0e4,0xb0e8,0xb0ec,0xb0f0,0xb0f4,0xb0f8,0xb0fc,0xc000,0xc004,0xc008,0xc00c,0xc010,0xc014,0xc018,0xc01c,0xc020,0xc024,0xc028,0xc02c,0xc030,0xc034,0xc038,0xc03c,0xc040,0xc044,0xc048,0xc04c,0xc050,0xc054,0xc058,0xc05c,0xc060,0xc064,0xc068,0xc06c,0xc070,0xc074,0xc078,0xc07c,0xc080,0xc084,0xc088,0xc08c,0xc090,0xc094,0xc098,0xc09c,0xc0a0,0xc0a4,0xc0a8,0xc0ac,0xc0b0,0xc0b4,0xc0b8,0xc0bc,0xc0c0,0xc0c4,0xc0c8,0xc0cc,0xc0d0,0xc0d4,0xc0d8,0xc0dc,0xc0e0,0xc0e4,0xc0e8,0xc0ec,0xc0f0,0xc0f4,0xc0f8,0xc0fc,0xd000,0xd004,0xd008,0xd00c,0xd010,0xd014,0xd018,0xd01c,0xd020,0xd024,0xd028,0xd02c,0xd030,0xd034,0xd038,0xd03c,0xd040,0xd044,0xd048,0xd04c,0xd050,0xd054,0xd058,0xd05c,0xd060,0xd064,0xd068,0xd06c,0xd070,0xd074,0xd078,0xd07c,0xd080,0xd084,0xd088,0xd08c,0xd090,0xd094,0xd098,0xd09c,0xd0a0,0xd0a4,0xd0a8,0xd0ac,0xd0b0,0xd0b4,0xd0b8,0xd0bc,0xd0c0,0xd0c4,0xd0c8,0xd0cc,0xd0d0,0xd0d4,0xd0d8,0xd0dc,0xd0e0,0xd0e4,0xd0e8,0xd0ec,0xd0f0,0xd0f4,0xd0f8,0xd0fc,0xe000,0xe004,0xe008,0xe00c,0xe010,0xe014,0xe018,0xe01c,0xe020,0xe024,0xe028,0xe02c,0xe030,0xe034,0xe038,0xe03c,0xe040,0xe044,0xe048,0xe04c,0xe050,0xe054,0xe058,0xe05c,0xe060,0xe064,0xe068,0xe06c,0xe070,0xe074,0xe078,0xe07c,0xe080,0xe084,0xe088,0xe08c,0xe090,0xe094,0xe098,0xe09c,0xe0a0,0xe0a4,0xe0a8,0xe0ac,0xe0b0,0xe0b4,0xe0b8,0xe0bc,0xe0c0,0xe0c4,0xe0c8,0xe0cc,0xe0d0,0xe0d4,0xe0d8,0xe0dc,0xe0e0,0xe0e4,0xe0e8,0xe0ec,0xe0f0,0xe0f4,0xe0f8,0xe0fc,0xf000,0xf004,0xf008,0xf00c,0xf010,0xf014,0xf018,0xf01c,0xf020,0xf024,0xf028,0xf02c,0xf030,0xf034,0xf038,0xf03c,0xf040,0xf044,0xf048,0xf04c,0xf050,0xf054,0xf058,0xf05c,0xf060,0xf064,0xf068,0xf06c,0xf070,0xf074,0xf078,0xf07c,0xf080,0xf084,0xf088,0xf08c,0xf090,0xf094,0xf098,0xf09c,0xf0a0,0xf0a4,0xf0a8,0xf0ac,0xf0b0,0xf0b4,0xf0b8,0xf0bc,0xf0c0,0xf0c4,0xf0c8,0xf0cc,0xf0d0,0xf0d4,0xf0d8,0xf0dc,0xf0e0,0xf0e4,0xf0e8,0xf0ec,0xf0f0,0xf0f4,0xf0f8,0xf0fc,0x0,0x4,0x8,0xc,0x10,0x14,0x18,0x1c,0x20,0x24,0x28,0x2c,0x30,0x34,0x38,0x3c,0x40,0x44,0x48,0x4c,0x50,0x54,0x58,0x5c,0x60,0x64,0x68,0x6c,0x70,0x74,0x78,0x7c,0x80,0x84,0x88,0x8c,0x90,0x94,0x98,0x9c,0xa0,0xa4,0xa8,0xac,0xb0,0xb4,0xb8,0xbc,0xc0,0xc4,0xc8,0xcc,0xd0,0xd4,0xd8,0xdc,0xe0,0xe4,0xe8,0xec,0xf0,0xf4,0xf8,0xfc,0x1000,0x1004,0x1008,0x100c,0x1010,0x1014,0x1018,0x101c,0x1020,0x1024,0x1028,0x102c,0x1030,0x1034,0x1038,0x103c,0x1040,0x1044,0x1048,0x104c,0x1050,0x1054,0x1058,0x105c,0x1060,0x1064,0x1068,0x106c,0x1070,0x1074,0x1078,0x107c,0x1080,0x1084,0x1088,0x108c,0x1090,0x1094,0x1098,0x109c,0x10a0,0x10a4,0x10a8,0x10ac,0x10b0,0x10b4,0x10b8,0x10bc,0x10c0,0x10c4,0x10c8,0x10cc,0x10d0,0x10d4,0x10d8,0x10dc,0x10e0,0x10e4,0x10e8,0x10ec,0x10f0,0x10f4,0x10f8,0x10fc,0x2000,0x2004,0x2008,0x200c,0x2010,0x2014,0x2018,0x201c,0x2020,0x2024,0x2028,0x202c,0x2030,0x2034,0x2038,0x203c,0x2040,0x2044,0x2048,0x204c,0x2050,0x2054,0x2058,0x205c,0x2060,0x2064,0x2068,0x206c,0x2070,0x2074,0x2078,0x207c,0x2080,0x2084,0x2088,0x208c,0x2090,0x2094,0x2098,0x209c,0x20a0,0x20a4,0x20a8,0x20ac,0x20b0,0x20b4,0x20b8,0x20bc,0x20c0,0x20c4,0x20c8,0x20cc,0x20d0,0x20d4,0x20d8,0x20dc,0x20e0,0x20e4,0x20e8,0x20ec,0x20f0,0x20f4,0x20f8,0x20fc,0x3000,0x3004,0x3008,0x300c,0x3010,0x3014,0x3018,0x301c,0x3020,0x3024,0x3028,0x302c,0x3030,0x3034,0x3038,0x303c,0x3040,0x3044,0x3048,0x304c,0x3050,0x3054,0x3058,0x305c,0x3060,0x3064,0x3068,0x306c,0x3070,0x3074,0x3078,0x307c,0x3080,0x3084,0x3088,0x308c,0x3090,0x3094,0x3098,0x309c,0x30a0,0x30a4,0x30a8,0x30ac,0x30b0,0x30b4,0x30b8,0x30bc,0x30c0,0x30c4,0x30c8,0x30cc,0x30d0,0x30d4,0x30d8,0x30dc,0x30e0,0x30e4,0x30e8,0x30ec,0x30f0,0x30f4,0x30f8,0x30fc,0x4000,0x4004,0x4008,0x400c,0x4010,0x4014,0x4018,0x401c,0x4020,0x4024,0x4028,0x402c,0x4030,0x4034,0x4038,0x403c,0x4040,0x4044,0x4048,0x404c,0x4050,0x4054,0x4058,0x405c,0x4060,0x4064,0x4068,0x406c,0x4070,0x4074,0x4078,0x407c,0x4080,0x4084,0x4088,0x408c,0x4090,0x4094,0x4098,0x409c,0x40a0,0x40a4,0x40a8,0x40ac,0x40b0,0x40b4,0x40b8,0x40bc,0x40c0,0x40c4,0x40c8,0x40cc,0x40d0,0x40d4,0x40d8,0x40dc,0x40e0,0x40e4,0x40e8,0x40ec,0x40f0,0x40f4,0x40f8,0x40fc,0x5000,0x5004,0x5008,0x500c,0x5010,0x5014,0x5018,0x501c,0x5020,0x5024,0x5028,0x502c,0x5030,0x5034,0x5038,0x503c,0x5040,0x5044,0x5048,0x504c,0x5050,0x5054,0x5058,0x505c,0x5060,0x5064,0x5068,0x506c,0x5070,0x5074,0x5078,0x507c,0x5080,0x5084,0x5088,0x508c,0x5090,0x5094,0x5098,0x509c,0x50a0,0x50a4,0x50a8,0x50ac,0x50b0,0x50b4,0x50b8,0x50bc,0x50c0,0x50c4,0x50c8,0x50cc,0x50d0,0x50d4,0x50d8,0x50dc,0x50e0,0x50e4,0x50e8,0x50ec,0x50f0,0x50f4,0x50f8,0x50fc,0x6000,0x6004,0x6008,0x600c,0x6010,0x6014,0x6018,0x601c,0x6020,0x6024,0x6028,0x602c,0x6030,0x6034,0x6038,0x603c,0x6040,0x6044,0x6048,0x604c,0x6050,0x6054,0x6058,0x605c,0x6060,0x6064,0x6068,0x606c,0x6070,0x6074,0x6078,0x607c,0x6080,0x6084,0x6088,0x608c,0x6090,0x6094,0x6098,0x609c,0x60a0,0x60a4,0x60a8,0x60ac,0x60b0,0x60b4,0x60b8,0x60bc,0x60c0,0x60c4,0x60c8,0x60cc,0x60d0,0x60d4,0x60d8,0x60dc,0x60e0,0x60e4,0x60e8,0x60ec,0x60f0,0x60f4,0x60f8,0x60fc,0x7000,0x7004,0x7008,0x700c,0x7010,0x7014,0x7018,0x701c,0x7020,0x7024,0x7028,0x702c,0x7030,0x7034,0x7038,0x703c,0x7040,0x7044,0x7048,0x704c,0x7050,0x7054,0x7058,0x705c,0x7060,0x7064,0x7068,0x706c,0x7070,0x7074,0x7078,0x707c,0x7080,0x7084,0x7088,0x708c,0x7090,0x7094,0x7098,0x709c,0x70a0,0x70a4,0x70a8,0x70ac,0x70b0,0x70b4,0x70b8,0x70bc,0x70c0,0x70c4,0x70c8,0x70cc,0x70d0,0x70d4,0x70d8,0x70dc,0x70e0,0x70e4,0x70e8,0x70ec,0x70f0,0x70f4,0x70f8,0x70fc};

expected = {0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffe,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffd,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffc,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfffb,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff8,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xfff0,0xffef,0xffef,0xffef,0xffff,0x4000,0x2000,0x1555,0x1000,0xccc,0xaaa,0x924,0x800,0x71c,0x666,0x5d1,0x555,0x4ec,0x492,0x444,0x400,0x3c3,0x38e,0x35e,0x333,0x30c,0x2e8,0x2c8,0x2aa,0x28f,0x276,0x25e,0x249,0x234,0x222,0x210,0x200,0x1f0,0x1e1,0x1d4,0x1c7,0x1ba,0x1af,0x1a4,0x199,0x18f,0x186,0x17d,0x174,0x16c,0x164,0x15c,0x155,0x14e,0x147,0x141,0x13b,0x135,0x12f,0x129,0x124,0x11f,0x11a,0x115,0x111,0x10c,0x108,0x104,0x10,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0xf,0x8,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x7,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x4,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2,0x2};

index = 1
output = 0x0
fail = 0

function setupFirstTest(address, value)
	--emu.log(string.format("%x",input[index]))
	emu.writeWord(0x5E0,input[index],emu.memType.gsuWorkRam)
end

emu.addMemoryCallback(setupFirstTest,
					  emu.callbackType.exec,
					  0x00C,
					  0x00C,
					  4,
					  emu.memType.gsuWorkRam)

function setNextInput()
	emu.writeWord(0x5E0,input[index],emu.memType.gsuWorkRam)
end

function compareAndLogOutput(address, value)
	local read = emu.readWord(0x5E2,emu.memType.gsuWorkRam,false)

	emu.log("Checking")

	if read ~= expected[index] then
		fail = 1
		emu.log(input[index])
		emu.log(read)
		emu.log(expected[index])
		emu.log(index)

		emu.log(string.format("Error reciprocal(%x) was %x expected %x", input[index],read,expected[index]))
	end
	index=index+1
	loopOrExit()
end

function loopOrExit()
	if index > 1024 then
		emu.log("Done")
		--emu.stop(fail)
		emu.breakExecution()
	else
		setNextInput()
	end
end


emu.addMemoryCallback(compareAndLogOutput,
					  emu.callbackType.exec,
					  0x0030,
					  0x0030,
					  4,
					  emu.memType.gsuWorkRam)